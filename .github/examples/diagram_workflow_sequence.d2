# 経費申請承認業務のシーケンス図
# =========================
# 業務プロセス: 経費申請から承認・支払いまでの業務フロー

## レイアウトエンジンとテーマの定義
## -------------------------
vars: {
  d2-config: {
    layout-engine: elk
    theme-id: 0
  }
}

## シーケンス図の宣言
## -------------------------
shape: sequence_diagram

## スタイル定義
## -------------------------
classes: {
  申請者: {
    shape: person
    style: {
      fill: lightblue
    }
  }
  部門: {
    shape: rectangle
    style: {
      fill: lightgreen
    }
  }
  システム: {
    shape: cylinder
    style: {
      fill: lightgray
    }
  }
  外部組織: {
    shape: cloud
    style: {
      fill: lightyellow
    }
  }
  依頼: {
    style: {
      font-size: 12
      stroke: blue
    }
  }
  承認: {
    style: {
      font-size: 12
      stroke: green
    }
  }
  報告: {
    style: {
      font-size: 12
      stroke: orange
      stroke-dash: 3
    }
  }
  通知: {
    style: {
      font-size: 10
      stroke: gray
      stroke-dash: 5
    }
  }
}

## アクターの定義
## -------------------------
申請者: {
  label: "田中（申請者）"
  class: 申請者
}
経理部: {
  label: "経理部"
  class: 部門
}
営業部長: {
  label: "営業部長"
  class: 申請者
}
経費管理システム: {
  label: "経費管理システム"
  class: システム
}
銀行: {
  label: "取引銀行"
  class: 外部組織
}

## シーケンスの定義
## -------------------------
### 経費申請
経費申請: {
  label: "経費申請"
  申請者 -> 経費管理システム: "経費申請書入力" {
    label: "交通費 5,000円"
    class: 依頼
  }

  経費管理システム -> 営業部長: "承認依頼通知" {
    label: "田中さんから経費申請"
    class: 通知
  }

  営業部長 -> 経費管理システム: "申請内容確認" {
    label: "内容チェック"
    class: 依頼
  }

  営業部長 -> 経費管理システム: "承認" {
    label: "承認します"
    class: 承認
  }

  経費管理システム -> 申請者: "承認通知" {
    label: "部長承認完了"
    class: 通知
  }
}

### 経理処理
経理処理: {
  label: "経理部での処理"
  経費管理システム -> 経理部: "承認済み申請通知" {
    label: "田中さんの経費申請"
    class: 通知
  }

  経理部 -> 経費管理システム: "内容確認" {
    label: "領収書チェック"
    class: 依頼
  }

  経理部 -> 経費管理システム: "支払処理登録" {
    label: "支払予定日設定"
    class: 依頼
  }

  経理部 -> 申請者: "処理完了通知" {
    label: "支払処理しました"
    class: 報告
  }
}

### 支払処理
支払処理: {
  label: "銀行振込処理"
  経理部 -> 銀行: "振込依頼" {
    label: "田中への5,000円振込"
    class: 依頼
  }

  銀行 -> 経理部: "振込完了通知" {
    label: "振込処理完了"
    class: 報告
  }

  経理部 -> 経費管理システム: "支払完了登録" {
    label: "ステータス更新"
    class: 依頼
  }

  経費管理システム -> 申請者: "支払完了通知" {
    label: "5,000円をお振込みしました"
    class: 通知
  }

  申請者 -> 経理部: "受領確認" {
    label: "確認しました。ありがとうございます"
    class: 報告
  }
}

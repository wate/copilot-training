---
mode: agent
model: Claude Sonnet 4
---
ディレクトリ構造ドキュメント生成
=========================

役割
-------------------------

[システムアナリスト](../chatmodes/system-analyst.chatmode.md)

### タスク固有の追加専門性

- プロジェクトディレクトリ構造の分析と理解
- ファイルシステム階層の体系的な整理と分類
- 技術文書としてのディレクトリ構造表現の最適化
- 開発プロジェクトにおけるディレクトリ役割の理解

指示/タスク
-------------------------

### ディレクトリ構造分析

プロジェクトのディレクトリ構造を分析し、技術文書として体系化されたディレクトリ構造ドキュメントを生成します。

#### 主要タスク

以下のタスクを順序立てて実行する：

1. ディレクトリ構造の走査と情報収集
2. 設定ファイル・例外ファイルの存在確認
3. 階層構造の整理と分類
4. 技術文書形式での出力生成

#### 実行時の考慮事項

- 技術的制約: 階層深度制限、特定パスでの例外処理
- 品質基準: 一貫した説明記述、正確な階層表現
- 可読性: 開発者が理解しやすい構造表現
- 保守性: 将来の構造変更に対応可能な記述方式

#### 品質確認項目

- 階層表現の正確性: 罫線記号と階層の対応確認
- 説明文の適切性: 各ディレクトリ役割の明確な記述
- 例外処理の正確性: 設定ファイル・除外対象の正しい処理

### 出力構造規則

#### 基本出力内容

1. ディレクトリのみを出力（ファイルは出力しない）
2. 例外事項で指定されたファイルは含める
3. 排除対象は出力しない

#### 階層制御規則

##### 基本階層制限

- 標準: 2階層目まで出力
- 例外: `src/`、`templates/`配下は3階層目まで出力

##### ディレクトリ表記規則

- ディレクトリ末尾: `/`を付与
- 説明記載: `# 日本語説明文`形式
- インデント: 階層に応じて4スペース単位

##### 罫線表記規則

- 縦線: `│`使用
- 分岐: `├`使用  
- 終端: `└`使用
- 横線: `─`は使用しない

#### 出力順序規則

1. ディレクトリ昇順、ファイル昇順での出力
2. トップディレクトリ設定ファイルは最後に配置
3. `README.*`ファイルは最初に出力

制約・禁止事項
-------------------------

### 技術的制約

- 階層制限: 基本2階層、特定パス（`src/`、`templates/`）のみ3階層
- 表記統一: 罫線記号の厳密な使用規則準拠
- ディレクトリ識別: 末尾`/`による明確な区別

### 禁止事項

#### 表記制約違反

- カレントディレクトリ表記`./`の使用
- 横線記号`─`の使用
- 不適切な階層表現

#### 出力制約違反

- 規定階層を超える深い階層の出力
- 除外対象の誤った出力

### 例外処理規則

#### 出力対象ファイル（存在する場合のみ）

##### 開発環境・依存性管理

- `.devcontainer/`: ローカル開発環境構築用設定ディレクトリ
- `vendor/`: 依存パッケージ管理ディレクトリ
- `webroot/index.php`: Webサーバールート実行ファイル

##### 設定ファイル群

###### パッケージマネージャー設定

各言語のパッケージマネージャー設定ファイル

###### Linter設定ファイル

- EditorConfig: `.editorconfig`
- Markdownlint: `.markdownlint.yml`、`.markdownlint.yaml`、`.markdownlint.json`
- PHP: `phpcs.xml`、`phpstan.neon`、`phpstan.neon.dist`、`phpstan.dist.neon`、`.php-cs-fixer.dist.php`、`.php-cs-fixer.php`
- Prettier: `.prettierrc`、`.prettierrc.*`
- ESLint: `.eslint.config.js`、`.eslintrc`、`.eslintrc.*`、`package.json`（`eslintConfig`セクション）
- Stylelint: `stylelint.config.js`、`.stylelintrc`、`.stylelintrc.*`、`package.json`（`stylelint`セクション）
- yamllint: `.yamllint`、`.yamllint.yml`、`.yamllint.yaml`
- textlint: `.textlintrc`、`.textlintrc.*`
- Ansible-lint: `.ansible-lint`、`.ansible-lint.yml`、`.ansible-lint.yaml`
- Ruby: `.rubocop.yml`、`.rubocop_todo.yml`

###### デプロイ・ビルド設定

- `ansible.cfg`: Ansible設定ファイル
- `deploy.yml`: Ansibleデプロイ用Playbook
- `inventory.yml`: Ansibleインベントリファイル
- `Taskfile.yml`: Task設定ファイル
- `mkdocs.yml`: MkDocs設定ファイル
- `tsconfig.json`: TypeScript設定ファイル
- `rollup.config.js`: Rollup設定ファイル
- `.tbls.yml`または`tbls.yml`: テーブル定義ドキュメント生成ツール設定
- `.pre-commit-config.yaml`: pre-commit設定ファイル
- `README.*`: プロジェクト概要ドキュメント

#### 除外対象

- `.devcontainer/*`: 開発環境設定内容
- `vendor/*`: 依存パッケージ内容
- `tree.txt`: treeコマンド出力結果
- `provision_config.yml`: プロビジョニング設定

#### 特別順序規則

- `README.*`: 最優先出力

出力フォーマット
-------------------------

### 必須出力項目

- Markdown形式でのディレクトリ構造表現
- 罫線記号を用いた視覚的な階層構造
- 各ディレクトリの役割・目的の明確な記述
- インデント・記号使用の統一性

### 詳細出力例

[出力内容のサンプル](../examples/doc_directory_structure.md)

### 出力構造

```
├ README.md                 # READMEファイル
├ ディレクトリ名/             # ディレクトリの役割説明
│   ├ サブディレクトリ名/        # サブディレクトリの役割説明
│   └ 最後のサブディレクトリ/    # 最後のサブディレクトリの説明
├ 設定ファイル名.ext         # 設定ファイルの説明
└ 最後のディレクトリ/        # 最後のディレクトリの説明
```

出力先ファイル名および命名規則
-------------------------

### ファイル配置ルール

- 出力ファイル: `docs/directory_structure.md`
- ディレクトリが存在しない場合は作成する

### 命名規則

- ファイル名: ディレクトリ構造の内容を明確に表現
- 配置場所: プロジェクトドキュメント標準ディレクトリ
- 文字エンコーディング: UTF-8

エラーハンドリング
-------------------------

### 基本的なエラーパターン

- ディレクトリアクセス権限不足: 権限エラー時の代替処理
- 存在しないパス参照: パス確認とエラー回避
- 文字エンコーディング問題: UTF-8での安全な処理
